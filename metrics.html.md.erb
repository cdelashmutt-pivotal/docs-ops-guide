---
title: Monitoring a Pivotal Cloud Foundry Deployment
owner: Cloud Ops
---

<strong><%= modified_date %></strong>

This topic describes how to set up Pivotal Cloud Foundry (PCF) with third-party monitoring platforms to continuously monitor system metrics and trigger health alerts.

To perform a manual, one-time check of current PCF system status from Ops Manager, see [Monitoring Virtual Machines in Pivotal Cloud Foundry](../customizing/monitoring.html).

Pivotal recommends that operators experiment with different combinations of metrics and alerts appropriate to their specific requirements. As an example, the [Datadog Config repository](https://github.com/pivotal-cf-experimental/datadog-config-oss/blob/master/cloud-ops-example-doc.md) shows how the Pivotal Cloud Ops team monitors the health of its Cloud Foundry deployments using a customized Datadog dashboard.

<p class='note'><strong>Note</strong>: Pivotal does not officially support Datadog.</p>

## <a id='overview'></a>Overview

To set up PCF monitoring, you configure PCF and your monitoring platform as follows.

* In PCF, you install a [nozzle](../loggregator/architecture.html#nozzles) that extracts key metrics from the Firehose and sends it to a monitoring platform, such as [Datadog](https://www.datadoghq.com/) or [OpenTDSB](http://opentsdb.net/).

* In your monitoring platform, you customize:
  - A dashboard that lets you check and diagnose system health, and
  - Alerts that generate communications regarding attention-worthy conditions.

## <a id='sources'></a>Metrics Sources

In PCF, the Loggregator [Firehose](../loggregator/architecture.html#firehose)  endpoint streams metrics and logs aggregated from all Elastic Runtime component VMs, both system components and hosts. These metrics come from three sources: the BOSH health monitor, Cloud Foundry components, and custom metrics such as smoke tests. All of them

### <a id='bosh'></a> BOSH Health Monitor

The BOSH layer that underlies PCF generates `healthmonitor` metrics for all virtual machines (VMs) in the deployment. For monitoring system health, the most important of these are:

* `bosh.healthmonitor.system.cpu`: CPU usage, percent of total available on VM
* `bosh.healthmonitor.system.mem`: Memory usage, percent of total available on VM
* `bosh.healthmonitor.system.disk`: Disk usage, percent of total available on VM
* `bosh.healthmonitor.system.healthy`: `1` if VM is healthy, `0` otherwise

### <a id='cf'></a>Cloud Foundry Components

Cloud Foundry component VMs for executive control, hosting, routing, traffic control, authentication, and other internal functions generate metrics. See [Cloud Foundry Component Metrics](../loggregator/all_metrics.html) for a detailed listing of metrics generated by Cloud Foundry.

Component metrics that are often useful to monitor include:

* `auctioneer.AuctioneerFetchStatesDuration`
* `auctioneer.AuctioneerLRPAuctionsFailed`
* `bbs.Domain.cf_apps`
* `bbs.CrashedActualLRPs`
* `bbs.LRPsMissing`
* `bbs.ConvergenceLRPDuration`
* `bbs.RequestLatency`
* `DopplerServer.listeners.receivedEnvelopes`
* `DopplerServer.TruncatingBuffer.totalDroppedMessages`
* `gorouter.total_routes`
* `gorouter.ms_since_last_registry_update`
* `MetronAgent.dropsondeMarshaller.sentEnvelopes`
* `nsync_bulker.DesiredLRPSyncDuration`
* `rep.CapacityRemainingMemory`
* `rep.CapacityTotalMemory`
* `rep.RepBulkSyncDuration`
* `route_emitter.RouteEmitterSyncDuration`

### <a id='smoke-tests'></a> Smoke Tests

The most important metrics for system health monitoring are smoke tests. These custom metrics are specifically designed to gauge system health. 


## <a id=' '></a>Extracting Metrics from the Firehose




## <a id=''></a>Monitoring Platforms




